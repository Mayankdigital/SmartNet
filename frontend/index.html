<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NetScheduler Pro: Adaptive Network Manager</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        /* Temporarily adding this style block to ensure the new filter is aligned */
        .monitor-header-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }
        .filter-dropdown {
            padding: 8px 15px;
            border-radius: 8px;
            border: 1.5px solid rgba(0, 102, 255, 0.3);
            background: rgba(255, 255, 255, 0.8);
            font-size: 14px;
            color: #1a2332;
            cursor: pointer;
            outline: none;
            transition: all 0.3s ease;
        }
        .filter-dropdown:hover {
            border-color: #0066ff;
            box-shadow: 0 2px 10px rgba(0, 102, 255, 0.1);
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-left">
            <div class="app-logo">N</div>
            <div class="app-name">NetScheduler Pro</div>
        </div>
        <div class="nav-right">
            <div class="status-indicator">
                <div class="status-dot status-online" id="statusDot"></div>
                <span id="statusText">Online</span>
            </div>

            <select class="mode-selector" id="modeSelector">
                <option value="work">Work Mode</option>
                <option value="gaming">Gaming Mode</option>
                <option value="entertainment">Entertainment</option>
                <option value="night">Night Mode</option>
                <option value="custom">Custom</option>
            </select>
            <button class="kill-btn" onclick="emergencyKill()">Emergency Kill</button>
        </div>
    </nav>

    <div class="main-container">
        <div class="sidebar">
            <div class="sidebar-item active" data-section="dashboard">
                <div class="sidebar-icon">üìä</div>
                <span>Dashboard</span>
            </div>
            <div class="sidebar-item" data-section="monitor">
                <div class="sidebar-icon">üì°</div>
                <span>Real-time Monitor</span>
            </div>
            <div class="sidebar-item" data-section="bandwidth">
                <div class="sidebar-icon">üåê</div>
                <span>Bandwidth Manager</span>
            </div>
            <div class="sidebar-item" data-section="protocol">
                <div class="sidebar-icon">‚ö°</div>
                <span>Protocol Engine</span>
            </div>
            <div class="sidebar-item" data-section="scheduler">
                <div class="sidebar-icon">‚è∞</div>
                <span>Smart Scheduler</span>
            </div>
            <div class="sidebar-item" data-section="prefetch">
                <div class="sidebar-icon">‚¨áÔ∏è</div>
                <span>Prefetch Queue</span>
            </div>
            <div class="sidebar-item" data-section="analytics">
                <div class="sidebar-icon">üìà</div>
                <span>Analytics</span>
            </div>
        </div>

        <div class="content-container">
            <div class="dashboard-content active-section" id="dashboard">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-title">Download Speed</div>
                            <div class="stat-icon">‚¨áÔ∏è</div>
                        </div>
                        <div class="stat-value" id="downloadSpeed">0 MB/s</div>
                        <div class="stat-change positive">
                            <span>‚Üó</span>
                            <span>Live Data</span>
                        </div>
                        <div class="mini-graph">
                            <canvas id="downloadChart"></canvas>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-title">Upload Speed</div>
                            <div class="stat-icon">‚¨ÜÔ∏è</div>
                        </div>
                        <div class="stat-value" id="uploadSpeed">0 MB/s</div>
                        <div class="stat-change negative">
                            <span>‚Üò</span>
                            <span>Live Data</span>
                        </div>
                        <div class="mini-graph">
                            <canvas id="uploadChart"></canvas>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-title">Latency</div>
                            <div class="stat-icon">‚ö°</div>
                        </div>
                        <div class="stat-value" id="latency">0ms</div>
                        <div class="stat-change positive">
                            <span>‚Üó</span>
                            <span>Live Data</span>
                        </div>
                        <div class="mini-graph">
                            <canvas id="latencyChart"></canvas>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-title">Network Efficiency</div>
                            <div class="stat-icon">üéØ</div>
                        </div>
                        <div class="stat-value" id="efficiency">0%</div>
                        <div class="stat-change positive">
                            <span>‚Üó</span>
                            <span>Live Data</span>
                        </div>
                        <div class="mini-graph">
                            <canvas id="efficiencyChart"></canvas>
                        </div>
                    </div>
                </div>

                <div class="section-title">
                    <div class="section-title-left">
                        <div class="section-icon">üöÄ</div>
                        Active Applications
                    </div>
                    <button class="refresh-btn" onclick="refreshApplications()">
                        <span>üîÑ</span>
                        <span>Refresh</span>
                    </button>
                </div>

                <div class="apps-container" id="appsContainer"></div>

                <div class="bandwidth-section">
                    <div class="graph-header">
                        <h3>Bandwidth Usage Over Time</h3>
                        <div class="time-filters">
                            <div class="time-filter active" data-time="1h">1H</div>
                            <div class="time-filter" data-time="1d">1D</div>
                            <div class="time-filter" data-time="7d">7D</div>
                            <div class="time-filter" data-time="1m">1M</div>
                        </div>
                    </div>
                    <div class="bandwidth-graph">
                        <div class="chart-container">
                            <canvas id="bandwidthChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <div class="dashboard-content" id="monitor">
                <div class="monitor-header-row">
                    <div class="section-title" style="margin-bottom: 0;">
                        <div class="section-title-left">
                            <div class="section-icon" style="background: linear-gradient(135deg, #ff9500, #ffcc00); box-shadow: 0 4px 15px rgba(255, 149, 0, 0.25);">üì°</div>
                            Real-time Process Monitoring
                        </div>
                    </div>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <input type="text" id="processSearchInput" class="search-input" placeholder="Search applications..." onkeyup="renderApplications('monitor')">

                        <select class="filter-dropdown" id="policyStatusFilter" onchange="renderApplications('monitor')">
                            <option value="all">Policy Status: All</option>
                            <option value="applied">Policy Applied (‚úÖ)</option>
                            <option value="default">Default/Killed (‚ùå)</option>
                        </select>
                        
                        <button class="refresh-btn icon-btn" id="bandwidthSortBtn" title="Sort by Bandwidth">
                            <span>üì∂</span>
                        </button>
                        
                        <button class="refresh-btn icon-btn" onclick="requestProcessRescan()" title="Rescan Processes">
                            <span>üîÑ</span>
                        </button>
                    </div>
                </div>

                <div class="apps-container" id="monitorAppsContainer">
                </div>

                <div class="section-title" style="margin-top: 32px;">
                    <div class="section-title-left">
                        <div class="section-icon" style="background: linear-gradient(135deg, #34c759, #6dd68e); box-shadow: 0 4px 15px rgba(52, 199, 89, 0.25);">‚öôÔ∏è</div>
                        System Network Load
                    </div>
                </div>
                <div class="bandwidth-section">
                    <p style="font-size: 14px; color: #7a8a99; margin-bottom: 16px;">System-wide packet and protocol distribution, critical for dynamic switching decisions.</p>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div><canvas id="protocolDistributionChart" height="200"></canvas></div>
                        <div><canvas id="packetLossChart" height="200"></canvas></div>
                    </div>
                </div>
            </div>

            <div class="dashboard-content" id="bandwidth"></div>
            <div class="dashboard-content" id="protocol"></div>
            <div class="dashboard-content" id="scheduler"></div>
            <div class="dashboard-content" id="prefetch"></div>
            <div class="dashboard-content" id="analytics"></div>
        </div>
    </div>

    <div id="policyModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalAppName">Policy Editor</h3>
                <span class="close-btn" onclick="closeModal()">&times;</span>
            </div>
            <div class="modal-body">

                <h4>Apply Policy To Modes</h4>
                <div class="mode-checkbox-group" id="policyModeCheckboxes">
                </div>

                <h4>Bandwidth Priority Class (OS Scheduling)</h4>
                <select id="prioritySelect">
                    <option value="critical">Critical (Max Guarantee)</option>
                    <option value="high">High (Video/Voice)</option>
                    <option value="medium">Medium (Browsing/Streaming)</option>
                    <option value="low">Low (Background Downloads)</option>
                    <option value="block">Block (No Access)</option>
                </select>

                <div class="slider-group">
                    <label>Download Limit:</label>
                    <input type="range" id="downloadLimitSlider" min="0" max="100" step="1" value="50" oninput="updateLimitValue('download')">
                    <span id="downloadLimitValue">50 Mbps</span>
                </div>

                <div class="slider-group">
                    <label>Upload Limit:</label>
                    <input type="range" id="uploadLimitSlider" min="0" max="50" step="1" value="10" oninput="updateLimitValue('upload')">
                    <span id="uploadLimitValue">10 Mbps</span>
                </div>

                <p class="hint">Note: Sliders cap at theoretical maximum for demonstration.</p>
            </div>
            <div class="modal-footer">
                <button class="save-btn" onclick="savePolicyChanges()">Save Changes</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>